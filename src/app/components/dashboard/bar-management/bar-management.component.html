<div class="theme-background-container"></div>

<section class="header-card-white">
	<div class="group-container">
		<h2 class="highlighted-info">3</h2>
		<h3 class="description-info">Bars gérés</h3>
	</div>
	<div class="group-container">
		<h2 class="highlighted-info">Jonathan Bosi</h2>
		<h3 class="description-info">jonathan.bosi@lilo.org</h3>
	</div>
	<div class="group-container">
		<h2 class="highlighted-info">680</h2>
		<h3 class="description-info">Favoris</h3>
	</div>
</section>

<section class="bar-content">
	<div class="bar-management-header">
		<button mat-flat-button>
			<mat-icon class="add-icon" aria-hidden="false" aria-label="add" color="primary">add</mat-icon>
			NOUVELLE DEMANDE
		</button>
		<div class="bar-management-buttons-filter">
			<button mat-flat-button class="margin-right"
				(click)="toggleOwnershipRequests(false)"
				[ngClass]="{'is-active': !toggledOwnershipRequests}">MES BARS</button>
			<button mat-flat-button
				(click)="toggleOwnershipRequests(true)"
				[ngClass]="{'is-active': toggledOwnershipRequests}">MES DEMANDES</button>
		</div>
	</div>
	<ng-container *ngIf="!toggledOwnershipRequests; else requests">
		<div class="bar-management-cards" *ngIf="ownedBars.length; else loader">
			<div class="bar-management-card" *ngFor="let ownedBar of ownedBars; let barIndex = index">
				<div class="bar-management-card-header" (click)="toggleExpand(barIndex)">
					<div class="container-left">
						<mat-icon aria-hidden="false" aria-label="expand" *ngIf="!ownedBar.expand">expand_less</mat-icon>
						<mat-icon aria-hidden="false" aria-label="collapse" *ngIf="ownedBar.expand">expand_more</mat-icon>
						<h2 class="bar-name mod-marginTopReset mod-marginBottomReset">{{ ownedBar.name | uppercase }}</h2>
					</div>
					<span>Favoris: {{ ownedBar.favouritesCount }}</span>
				</div>
				<div class="bar-management-card-content" *ngIf="ownedBar.expand">
					<div>Adresse : {{ ownedBar.address }}</div>
	
					<div class="barDetails-container"
						[bar]="barData"
						labelEmpty="Les bières de ce bar n'ont pas été renseignées !"
						app-beer-table>
					</div>
	
					<div>Bière la moins chère en HH : {{ ownedBar.cheapestBeer }}€</div>
				</div>
			</div>
		</div>
	</ng-container>
	<ng-template #requests>
		<div class="bar-request-cards" *ngIf="ownershipRequests.length; else loader">
			<div class="bar-request-card" *ngFor="let request of ownershipRequests">
				<div class="bar-request-card-header">
					<h2 class="bar-name mod-marginTopReset mod-marginBottomReset">{{ request.name | uppercase }}</h2>
					<span *ngIf="!request.accepted && request.studied; else studiedOrAccepted">Demande: Refusée</span>
					<ng-template #studiedOrAccepted>
						<span>Etat de la demande: {{ request.accepted ? 'Acceptée' : request.studied ? 'étudiée' : 'en cours d étude' }}</span>
					</ng-template>
				</div>
			</div>
		</div>
	</ng-template>
</section>

<ng-template #loader>
	<div class="loading">
		<mat-spinner></mat-spinner>
	</div>
</ng-template>